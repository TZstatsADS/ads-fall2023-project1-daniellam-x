---
title: "Post Cleaning Analysis"
author: "Daniel Lam"
output:
  html_document:
    df_print: paged
---

Who is happier?

For this project I will utilize sentiment analysis to gain insights into the HappyDB database that helps answer the question about which groups of people are happier. To do this, I will use the sentimentr package to assign a sentiment score to each entry in the HappyDB database with a more positive score correlating with a more positive sentiment, a more negative score correlating with a more negative sentiment and a score of 0 correlating with a neutral sentiment. I will then split the data on the binary categories of marital, parenthood, and gender.
```{r load libraries, warning=FALSE, message=FALSE}
library(tidyverse)
library(DT)
library(sentimentr)
library(ggplot2)
```


```{r}
joined_data <- read_csv("../output/joined_data.csv")
```
```{r}
datatable(joined_data)
```




Conduct Sentiment analysis using the sentimentr package
```{r}
sentiment_scores = sentiment_by(joined_data$original_hm, by = NULL)
joined_data$sent_score = sentiment_scores$ave_sentiment
```

Examine data as a whole
```{r}

cat("Average Sentiment Score: ", mean(joined_data$sent_score), "\nMedian Sentiment Score: ", median(joined_data$sent_score))

ggplot(joined_data, aes(x = sent_score)) +    #fill = "blue", color = "black"
  geom_density(fill = "blue") +
  labs(title = "Sentiment Scores: All Data", x = "Score", y = "Density")

#ggplot(joined_data, aes(x = sent_score)) +
#  geom_histogram(binwidth = 0.1) +
#  labs(title = "Sentiment Scores: All Data", x = "Sentiment Score", y = "Frequency") +
#  theme_minimal()
```
The average and median sentiment scores indicate a positive sentiment throughout the database. I opted to use density plots instead of histograms throughout this project as it will make the slight differences between the population scores more noticeable. The density of the sentiment scores is bi-modal with the first maximum representing the large number of neutral entries which is explained by most of the entries describing an event/occurrence without using emotion-based words. The next maximum is inline with the average and median sentiment scores that were calculated.

Split the data on marital status
```{r}
df_married = subset(joined_data, marital == 'married')
df_single = subset(joined_data, marital == 'single')

cat("Married entries: ", dim(df_married)[1], "\nSingle entries: ", dim(df_single)[1])
cat("\n\nAverage Married Sentiment Score: ", mean(df_married$sent_score), "\nMedian Married Sentiment Score: ", median(df_married$sent_score))
cat("\n\nAverage Single Sentiment Score: ", mean(df_single$sent_score), "\nMedian Single Sentiment Score: ", median(df_single$sent_score))

ggplot(joined_data, aes(x = sent_score, fill = marital)) +
  geom_density(alpha = 0.5) +  # Use alpha to make overlapping areas transparent
  labs(title = "Sentiment Scores: Marital", x = "Score", y = "Density")

```
There are more single entries in than married in the database. The data indicates that married people have slightly more positive entries in the database than single people. This is also evident in the overlapping density plots by the peak and slight curve of the married plot outside of the single plot on the second maximum. This is not trivial as there are less entries from married people in the database so the difference can not be explained by more married entries. 

Split the data on parenthood status
```{r}
df_parent = subset(joined_data, parenthood == 'y')
df_notparent = subset(joined_data, parenthood == 'n')

cat("Parent entries: ", dim(df_parent)[1], "\nNon-parent entries: ", dim(df_notparent)[1])
cat("\n\nAverage Parent Sentiment Score: ", mean(df_parent$sent_score), "\nMedian Parent Sentiment Score: ", median(df_parent$sent_score))
cat("\n\nAverage Non-parent Sentiment Score: ", mean(df_notparent$sent_score), "\nMedian Non-parent Sentiment Score: ", median(df_notparent$sent_score))

ggplot(joined_data, aes(x = sent_score, fill = parenthood)) +
  geom_density(alpha = 0.5) +  # Use alpha to make overlapping areas transparent
  labs(title = "Sentiment Scores: Parenthood", x = "Score", y = "Density")
```

Split the data on gender
```{r}
df_m = subset(joined_data, gender == 'm')
df_f = subset(joined_data, gender == 'f')

cat("Average Male Sentiment Score: ", mean(df_m$sent_score), "\nMedian Male Sentiment Score: ", median(df_m$sent_score))
cat("\n\nAverage Female Sentiment Score: ", mean(df_f$sent_score), "\nMedian Female Sentiment Score: ", median(df_f$sent_score))

ggplot(joined_data, aes(x = sent_score, fill = gender)) +
  geom_density(alpha = 0.5) +  # Use alpha to make overlapping areas transparent
  labs(title = "Sentiment Scores: Gender", x = "Score", y = "Density")
```














